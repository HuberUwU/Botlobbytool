<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Panel de macros</title>
  <style>
    :root {
      --primary: #000000;
      --primary-dark: #606060;
      --secondary: #00f7ff;
      --dark: #0f0f0f;
      --light: #f8fafc;
      --host-color: #f97316;
      --player-color: #3b82f6;
      --selected-color: #22c55e;
      --controlbar-gradient-start: #656565;
      --controlbar-gradient-end: #000000;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: var(--dark);
      color: var(--light);
      margin: 0;
      padding: 0;
      min-height: 100vh;
      box-sizing: border-box;
    }
    
    h1 {
      text-align: center;
      font-size: 20px;
      margin: 0;
      color: var(--light);
      padding: 10px 0;
      background: linear-gradient(to right, var(--controlbar-gradient-start), var(--controlbar-gradient-end));
      box-shadow: 0 1px 4px rgba(0, 0, 0, 0.3);
    }
    
    .macro-container {
      display: flex;
      flex-direction: column;
      gap: 10px;
      max-width: 800px;
      margin: 0 auto;
      padding: 10px;
    }
    
    .game-mode-indicator {
      text-align: center;
      font-size: 16px;
      margin: 10px 0;
      font-weight: bold;
      background-color: rgba(255, 255, 255, 0.1);
      padding: 5px;
      border-radius: 4px;
    }
    
    .macro-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
      margin-top: 10px;
    }
    
    .macro-btn {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      background-color: #333;
      border: 1px solid #555;
      color: white;
      padding: 12px;
      border-radius: 5px;
      cursor: pointer;
      transition: all 0.2s ease;
      min-height: 80px;
      text-align: center;
    }
    
    .macro-btn:hover {
      background-color: #444;
      border-color: var(--secondary);
    }
    
    .macro-btn.active {
      background-color: var(--primary-dark);
      border-color: var(--selected-color);
      box-shadow: 0 0 10px rgb(0, 255, 21);
    }
    
    .macro-name {
      font-weight: bold;
      margin-bottom: 5px;
    }
    
    .macro-shortcut {
      font-size: 12px;
      opacity: 0.8;
    }
    
    .macro-description {
      font-size: 11px;
      margin-top: 5px;
      opacity: 0.7;
    }
    
    .no-macros {
      text-align: center;
      padding: 20px;
      background-color: rgba(255, 255, 255, 0.05);
      border-radius: 5px;
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <div class="macro-container">
    <h1>Panel de macros</h1>
    
    <div id="game-mode-indicator" class="game-mode-indicator">
      Chargement...
    </div>
    
    <div id="macro-grid" class="macro-grid">
      <!-- Les macros seront g√©n√©r√©es ici dynamiquement -->
    </div>
    
    <div id="no-macros" class="no-macros" style="display: none;">
      Aucune macro n'est disponible pour ce mode de jeu.
    </div>
  </div>
  
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // Recuperar el modo de juego a partir de los par√°metros de URL
      const urlParams = new URLSearchParams(window.location.search);
      const gameMode = urlParams.get('mode') || 'multiplayer';
      
      // Configuraci√≥n de macros por modo de juego
      const macrosByMode = {
        // Macros para multijugador y CDL (id√©nticas)
        multiplayer: [
          {
            id: 'macro1',
            name: 'B√∫squeda m√∫ltiple',
            shortcut: 'ALT+1',
            description: 'Presione R en todas las vistas',
            icon: 'üîç'
          },
          {
            id: 'macro2',
            name: 'Abandonar y Siguiente',
            shortcut: 'ALT+2',
            description: 'Secuencia: Esc, Tab x2, Enter',
            icon: '‚è≠Ô∏è'
          },
          {
            id: 'macro3',
            name: 'Pantalla completa',
            shortcut: 'ALT+3',
            description: 'Cambiar a pantalla completa (F11)',
            icon: 'üì∫'
          },
          {
            id: 'macro4',
            name: 'Movimiento autom√°tico',
            shortcut: 'ALT+M',
            description: 'Habilitar/deshabilitar movimientos autom√°ticos',
            icon: 'üîÑ',
            toggleable: true
          }
        ],
        
        // Copiar las mismas macros para CDL
        cdl: [],
        
        // Warzone: agregar solo macro de movimiento autom√°tico
        warzone: [
          {
            id: 'macro4',
            name: 'Movimiento autom√°tico',
            shortcut: 'ALT+M',
            description: 'Habilitar/deshabilitar movimientos autom√°ticos',
            icon: 'üîÑ',
            toggleable: true
          }
        ],
        
        // Warzone - Macros espec√≠ficas del modo Warzone
        warzone: [
          {
            id: 'macro5',
            name: 'Auto Drop',
            shortcut: 'ALT+D',
            description: 'Espacio en los hosts y luego en los jugadores despu√©s de 0,3 s',
            icon: 'ü™Ç',
            toggleable: false
          },
          {
            id: 'macro6',
            name: 'AFK Host',
            shortcut: 'ALT+H',
            description: 'Movimiento en los hosts (pulsaci√≥n de 1 s, pausa de 2 s)',
            icon: 'üè†',
            toggleable: true
          },
          {
            id: 'macro7',
            name: 'AFK Player',
            shortcut: 'ALT+P',
            description: 'Movimiento de los jugadores (pulsaci√≥n de 0,6 s, pausa de 1 s)',
            icon: 'üë§',
            toggleable: true
          },
          {
            id: 'macro8',
            name: 'AFK Host+Player',
            shortcut: 'ALT+A',
            description: 'Maintient l\'actividad en anfitriones y jugadores realizando una secuencia de movimientos ZQSD y presionando V (pu√±alada) cada 3 segundos solo en los jugadores. Se reinicia autom√°ticamente cada 60 segundos para evitar errores.',
            icon: 'üë•',
            toggleable: true
          }
        ]
      };
      
      // Copia las macros multijugador para cdl (son id√©nticas)
      macrosByMode.cdl = [...macrosByMode.multiplayer];
      
      // Actualizar el indicador de modo de juego
      const modeNames = {
        multiplayer: 'Multijugador',
        cdl: 'CDL',
        warzone: 'Warzone'
      };
      
      document.getElementById('game-mode-indicator').textContent = 
        `Mode: ${modeNames[gameMode] || gameMode}`;
      
      // Recuperar macros para este modo de juego
      const macros = macrosByMode[gameMode] || [];
      
      // Mostrar un mensaje si no hay ninguna macro disponible
      if (macros.length === 0) {
        document.getElementById('no-macros').style.display = 'block';
        document.getElementById('macro-grid').style.display = 'none';
      } else {
        document.getElementById('no-macros').style.display = 'none';
        document.getElementById('macro-grid').style.display = 'grid';
        
        // Generar botones de macro
        const macroGrid = document.getElementById('macro-grid');
        macroGrid.innerHTML = '';
        
        macros.forEach(macro => {
          const btn = document.createElement('div');
          btn.className = 'macro-btn';
          btn.id = macro.id;
          btn.dataset.id = macro.id;
          btn.dataset.toggleable = macro.toggleable || false;
          
          const nameEl = document.createElement('div');
          nameEl.className = 'macro-name';
          nameEl.textContent = `${macro.icon || ''} ${macro.name}`;
          
          const shortcutEl = document.createElement('div');
          shortcutEl.className = 'macro-shortcut';
          shortcutEl.textContent = macro.shortcut;
          
          const descEl = document.createElement('div');
          descEl.className = 'macro-description';
          descEl.textContent = macro.description;
          
          btn.appendChild(nameEl);
          btn.appendChild(shortcutEl);
          btn.appendChild(descEl);
          
          // Agregar el evento de clic
          btn.addEventListener('click', () => {
            // Para macros conmutables, alterne la clase activa
            if (macro.toggleable) {
              btn.classList.toggle('active');
            } else {
              // Efecto visual temporal para macros no alternables
              btn.classList.add('active');
              setTimeout(() => btn.classList.remove('active'), 500);
            }
            
            // Ejecutar la macro a trav√©s de la API
            if (window.macroAPI) {
              window.macroAPI.executeMacro(macro.id, gameMode);
            }
          });
          
          if (macro.id === 'macro8' || macro.name === 'AFK Host+Player') {
            macro.description = 'Mantiene la actividad en los anfitriones y jugadores realizando una secuencia de movimientos WASD y pulsaciones V (pu√±alada) cada 3 segundos solo en los jugadores. Se reinicia autom√°ticamente cada 60 segundos para evitar errores.';
          }
          
          macroGrid.appendChild(btn);
        });
      }
      
      // actualizaciones de estado de macro externas
      if (window.macroAPI && window.macroAPI.onMacroStatus) {
        window.macroAPI.onMacroStatus((status) => {
          const macroBtn = document.getElementById(status.macroId);
          if (macroBtn && macroBtn.dataset.toggleable === 'true') {
            if (status.running) {
              macroBtn.classList.add('active');
            } else {
              macroBtn.classList.remove('active');
            }
          }
        });
      }
      
      // Si la API est√° disponible, solicita las macros del proceso principal
      if (window.macroAPI && window.macroAPI.requestMacros) {
        window.macroAPI.requestMacros(gameMode);
        
        // Escuche las actualizaciones de macro disponibles
        if (window.macroAPI.onMacrosLoaded) {
          window.macroAPI.onMacrosLoaded((macrosData) => {
            // Esta caracter√≠stica permitir√≠a que las macros se actualicen din√°micamente.
            // Si se implementa en el backend
            console.log('Macros mises √† jour:', macrosData);
          });
        }
      }
    });
  </script>
</body>
</html> 